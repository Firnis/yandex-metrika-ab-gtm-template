___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Yandex Metrika Varioqub AB-tests",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Шаблон для подключения AB экспериментов Varioqub Yandex Metrika.",
  "containerContexts": [
    "WEB"
  ],
  "categories": ["EXPERIMENTATION"]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "clientId",
    "displayName": "clientId из Varioqub",
    "simpleValueType": true,
    "valueHint": "metrika.xxxxxx",
    "defaultValue": "metrika.xxxxxx"
  },
  {
    "type": "GROUP",
    "name": "config",
    "displayName": "Конфигурация",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "enableJS",
        "checkboxText": "enableJS",
        "simpleValueType": true,
        "defaultValue": false
      },
      {
        "type": "CHECKBOX",
        "name": "enableWatch",
        "checkboxText": "enableWatch",
        "simpleValueType": true,
        "defaultValue": false
      },
      {
        "type": "CHECKBOX",
        "name": "enableHTML",
        "checkboxText": "enableHTML",
        "simpleValueType": true,
        "defaultValue": true
      },
      {
        "type": "CHECKBOX",
        "name": "enableRedir",
        "checkboxText": "enableRedir",
        "simpleValueType": true,
        "defaultValue": true
      },
      {
        "type": "CHECKBOX",
        "name": "enableVisual",
        "checkboxText": "enableVisual",
        "simpleValueType": true,
        "defaultValue": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const injectScript = require('injectScript');
const createArgumentsQueue = require('createArgumentsQueue');
const ymab = createArgumentsQueue('ymab','ymab.a');
const jsexp = 'https://abt.s3.mds.yandex.net/expjs/latest/exp.js';

injectScript(jsexp, () => {
  ymab({
    clientId: data.clientId,
    config: {
      enableJS: data.enableJS,
      enableVisual: data.enableVisual,
      enableHTML: data.enableHTML,
      enableRedir: data.enableRedir,
      enableWatch: data.enableWatch,
    },
  });
  data.gtmOnSuccess();
}, data.gtmOnFailure);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ymab"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ymab.a"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://abt.s3.mds.yandex.net/expjs/latest/exp.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 11/8/2023, 12:41:44 PM


